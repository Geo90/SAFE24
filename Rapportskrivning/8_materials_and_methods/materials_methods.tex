
% this file is called up by thesis.tex



\chapter{Material \& metoder} % top level followed by section, subsection
\label{ch:metoder}

% ----------------------- paths to graphics ------------------------

% change according to folder and file names
\ifpdf
    \graphicspath{{8/figures/PNG/}{8/figures/PDF/}{8/figures/}}
\else
    \graphicspath{{8/figures/EPS/}{8/figures/}}
\fi

% ----------------------- contents from here ------------------------



\section{Metoder}
För att hela systemet skulle kunna fungera samtidigt så användes en schemaläggare så att varje komponent kunde vara aktiv utan att begränsa andra komponenter. Detta var nödvändigt att göra eftersom sensorer som användes skulle lyssna kontinuerligt på förändringar hos omgivningen medan systemet var aktivt och utförde andra uppgifter.\\

En server upprättades för att kunna ta emot data från kameran och lagra denna datan på en dator.\\

All kodning gjordes i Arduino IDE och olika bibliotek användes för att ansluta till ett WiFi-nätverk, skapa en schemaläggare, och kommunicera med kameran via HTTP.\\ 

\section{ESP8266 - mikroprocessorn}
Huvudanledningen för valet av denna mikroprocessor var att den hade en inbyggd Wifi-mottagare vilket var absolut nödvändigt för att kunna kommunicera med nätverket där kameran är upppkopplad. Givetvis kunde vi hitta på alternativa lösningar men just denna lösning var den smidigaste. I övrigt fanns det allt vi behövde till vårt projekt. Det fanns gott om digitala pins samt en analog på max, dock tog den emot max 1 V. \\

Vår tanke var att kopppla sensorer till vår ESP som sedan kommunicerade med kameran utifrån de uppgiffter som lästes in från sensorerna. ESP:n var då kopplad till samma nätverk som kameran och kommunicerade och skickade kommandon till kameran.\\
\section{FTP-Server}
För att kunna identifiera personer som ligger bakom skadegörelser behöver systemet lagra bilder eller/och filmer i en server och den är en viktig del av lösningen. Studenter valde att använda en FTP server som ska bilder och/eller filmer lagras.  FTP server ligger i samma subnät som IP-kameran ligger. Information om FTP server:

\begin{itemize}
\item IP adress : 192.168.0.106

\item Port nummer : 21

\item Användarnamn : ”FTP-User”

\item Lösenord : ”Safe24”

\end{itemize}
\section{IP-kameran}
Kameran som används är tillhandahållen av AXIS. Kameran är en Q6128-E Network Camera med möjlighet till internet uppkoppling sända bilder och streama video till en server.\\

IP-kameran användes för att skicka bilder och video till en server för datalagring.\\

Kommunikation med kameran gjordes via ESP8266 som sänder kommandon över internet för att styra kameran.\\

Studenterna skapade tre aktiviteter i kameran, ”ActionPTZStation1”, ”ActionRecord”, ”ActionPTZHome”.
ActionRecord är en aktivitet som spelar in en film som är en minut långt och skickar den filmen till en FTP server som har namnet FTP-Safe24. Filmens upplösning som skickas till FTP-server är 3840x2860. Ett suffix läggs i filmen som innehåller datum och tid information. ActionRecord aktiveras när virtuell port 9 är aktiv.\\
ActionPTZHome är aktivitet som riktar kameran till hemposition. Kamerans hemposition är definierat som position ”Safe24”. ActionPTZHome kan aktiveras genom att aktivera virtuell port nummer 10.
ActionPTZStation1 är aktivitet som riktar kameran till position som heter ”plats1” (busshållplatsen). ”. ActionPTZHome kan aktiveras genom att aktivera virtuell port nummer 8.


\section{Sensorer}
En PIR-sensor och en mikrofon användes.\\

PIR-sensorn registrerade ifall det förekom någon rörelse. Denna sensorn skickade digitala värden till ESP8266.\\

Mikrofonen som användes skickade analoga värden till ESP8266.\\



% ---------------------------------------------------------------------------
%: ----------------------- end of thesis sub-document ------------------------
% ---------------------------------------------------------------------------



 



